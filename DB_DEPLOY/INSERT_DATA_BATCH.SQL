--use sqlcmd -i file
SET ANSI_NULLS ON
GO
SET ANSI_PADDING ON
GO

DECLARE @table_name VARCHAR(100) = 'TAGS_DATA'
DECLARE @CREATE_QUERY VARCHAR(MAX)
DECLARE @INSERT_QUERY VARCHAR(MAX)
DECLARE @i INT = 0, @max INT = 48 -- 30 min in 1 DAY
DECLARE @dateStart smalldatetime = '2022-01-01 11:30'
DECLARE @time smalldatetime
USE BMS

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].'+@table_name) AND type in (N'U'))
BEGIN
PRINT "CREATE TABLE "+ @table_name
SET @CREATE_QUERY = '
CREATE TABLE [dbo].'+ @table_name +'(
	[tanggal] [smalldatetime] NOT NULL,
	[ACS1_AHU14A_SUPPLYAIR_F_CV] [real] NULL,
	[ACS1_AHU14A_FLOW_F_CV] [real] NULL,
	[ACS1_AHU14B_SUPPLYAIR_F_CV] [real] NULL,
	[ACS1_AHU14B_HUMIDITY_F_CV] [real] NULL,
	[ACS1_AHU14B_FLOW_F_CV] [real] NULL,
	[ACS1_AHU16_SUPPLYAIR_F_CV] [real] NULL,
	[ACS1_AHU16_HUMIDITY_F_CV] [real] NULL,
	[ACS1_AHU16_FLOW_F_CV] [real] NULL,
	[ACS1_AHU17_SUPPLYAIR_F_CV] [real] NULL,
	[ACS1_AHU94_SUPPLYAIR_F_CV] [real] NULL,
	[ACS1_AHU94_HUMIDITY_F_CV] [real] NULL,
	[ACS1_AHU94_FLOW_F_CV] [real] NULL,
	[ACS1_AHU24_1_SUPPLYAIR_F_CV] [real] NULL,
	[ACS1_AHU24_1_FLOW_F_CV] [real] NULL,
	[ACS1_AHU24_2_SUPPLYAIR_F_CV] [real] NULL,
	[ACS1_AHU24_2_HUMIDITY_F_CV] [real] NULL,
	[ACS1_AHU24_2_FLOW_F_CV] [real] NULL,
	[ACS1_AHU25_SUPPLYAIR_F_CV] [real] NULL,
	[ACS1_AHU25_FLOW_F_CV] [real] NULL,
	[ACS1_AHU28_SUPPLYAIR_F_CV] [real] NULL,
	[ACS1_AHU28_FLOW_F_CV] [real] NULL,
	[ASPJAKWR809PGZ_STILMAS_WFI_W_TE012] [real] NULL,
	[ASPJAKWR809PGZ_STILMAS_WFI_W_LE015] [real] NULL,
	[ASPJAKWR809PGZ_STILMAS_WFI_W_TE015_1] [real] NULL,
	[ASPJAKWR809PGZ_YokogawaDX2020_CH1_PV_CH07] [real] NULL,
	[ASPJAKWR809PGZ_STILMAS_WFI_W_TE015_5] [real] NULL,
	[ASPJAKWR809PGZ_YokogawaDX2020_CH1_PV_CH10] [real] NULL,
	[ASPJAKWR809PGZ_YokogawaDX2020_CH1_PV_CH11] [real] NULL,
	[ASPJAKWR809PGZ_YokogawaDX2020_CH1_PV_CH08] [real] NULL,
	[ASPJAKWR809PGZ_STILMAS_WFI_W_PT020] [real] NULL,
	[ASPJAKWR809PGZ_STILMAS_WFI_P_LT10_1] [real] NULL,
	[ASPJAKWR809PGZ_STILMAS_WFI_P_TE10_1] [real] NULL,
	[ASPJAKWR809PGZ_STILMAS_WFI_P_TE10_2] [real] NULL,
	[ASPJAKWR809PGZ_STILMAS_WFI_P_TE10_5] [real] NULL,
	[ASPJAKWR809PGZ_YokogawaDX2020_CH1_PV_CH13] [real] NULL,
	[ASPJAKWR809PGZ_STILMAS_WFI_P_PT10_1] [real] NULL,
	[ASPJAKWR809PGZ_YokogawaDX2020_CH1_PV_CH16] [real] NULL,
	[ASPJAKWR809PGZ_YokogawaDX2020_CH1_PV_CH17] [real] NULL,
	[ASPJAKWR809PGZ_YokogawaDX2020_CH1_PV_CH19] [real] NULL,
	[ASPJAKWR809PGZ_YokogawaDX2020_CH1_PV_CH18] [real] NULL,
	[ASPJAKWR809PGZ_YokogawaDX2020_CH1_PV_CH20] [real] NULL,
	[ACS1_TOC_DEMIN_F_CV] [real] NULL,
	[ACS1_ROOM158_TEMP_F_CV] [real] NULL,
	[ACS1_ROOM158_HUMIDITY_F_CV] [real] NULL,
	[ACS1_ROOM160_TEMP_F_CV] [real] NULL,
	[ACS1_ROOM160_HUMIDITY_F_CV] [real] NULL,
	[ACS1_ROOM_WIP_TEMP_F_CV] [real] NULL,
	[ACS1_ROOM_WIP_RH_F_CV] [real] NULL,
	[ACS1_ROOM312_TEMP_F_CV] [real] NULL,
	[ACS1_ROOM312_RH_F_CV] [real] NULL,
	[ACS1_ROOM321_TEMP_F_CV] [real] NULL,
	[ACS1_ROOM314_WIP_TEMP_F_CV] [real] NULL,
	[ACS1_ROOM167_HUMIDITY_F_CV] [real] NULL,
	[ACS1_ROOM167_TEMP_F_CV] [real] NULL,
	[ACS1_ROOM140_TEMP_F_CV] [real] NULL,
	[ACS1_ROOM140_HUMIDITY_F_CV] [real] NULL,
	[ACS1_ROOM125_PRESSURE_F_CV] [real] NULL,
	[ACS1_ROOM126_PRESSURE_F_CV] [real] NULL,
	[ACS1_ROOM127_PRESSURE_F_CV] [real] NULL,
	[ACS1_ROOM128_PRESSURE_F_CV] [real] NULL,
	[ACS1_ROOM140_PRESSURE_F_CV] [real] NULL,
	[ACS1_ROOM141_PRESSURE_F_CV] [real] NULL,
	[ACS1_ROOM145_PRESSURE_F_CV] [real] NULL,
	[ACS1_ROOM129_148_PRESSURE_F_CV] [real] NULL,
	[ASPJAKWR809PGZ_HORNR_STERILE_horner_str_delta_p] [real] NULL,
	[ASPJAKWR809PGZ_HORNR_STERILE_horner_str_ruang_126] [real] NULL,
	[ASPJAKWR809PGZ_HORNR_STERILE_horner_str_ruang_141] [real] NULL,
	[DP_R140_R126] [real] NULL,
	[DP_R141_R126] [real] NULL,
	[ACS1_FIN_GOOD_X1_F_CV] [real] NULL,
	[ACS1_FIN_GOOD_X2_F_CV] [real] NULL,
	[ACS1_FIN_GOOD_X3_F_CV] [real] NULL,
	[ACS1_FIN_GOOD_X4_F_CV] [real] NULL,
	[ACS1_FIN_GOOD_X5_F_CV] [real] NULL,
	[ACS1_FIN_GOOD_X6_F_CV] [real] NULL,
	[ACS1_FIN_GOOD_X7_F_CV] [real] NULL,
	[ACS1_RM_WAREHOUSE_X1_F_CV] [real] NULL,
	[ACS1_RM_WAREHOUSE_X2_F_CV] [real] NULL,
	[ACS1_RM_WAREHOUSE_X3_F_CV] [real] NULL,
	[ACS1_RM_WAREHOUSE_X4_F_CV] [real] NULL,
	[ACS1_RM_WAREHOUSE_X5_F_CV] [real] NULL,
	[ACS1_RM_WAREHOUSE_X6_F_CV] [real] NULL,
	[ACS1_COLDBOX_TEMP_F_CV] [real] NULL,
	[ACS1_FLAMMABLE_TEMP_F_CV] [real] NULL,
	[ACS1_ROOM133_TEMP_F_CV] [real] NULL,
	[ACS1_ROOM133_RH_F_CV] [real] NULL,
	[ACS1_ROOM328_TEMP_F_CV] [real] NULL,
	[ACS1_ROOM328_RH_F_CV] [real] NULL,
	[ACS1_ROOM182A_TEMP_F_CV] [real] NULL,
	[ACS1_ROOM183A_TEMP_F_CV] [real] NULL,
	[ACS1_ROOM183B_TEMP_F_CV] [real] NULL,
	[ACS1_SYSTEM_FLOW_F_CV] [real] NULL,
	[ACS1_SAMPLING_BOOTH_MAT_AIR_LOCK_F_CV] [real] NULL,
	[ACS1_SAMPLING_BOOTH_GOWNING_F_CV] [real] NULL,
	[COLD_CHAMBER_L_214_01] [real] NULL,
	[R_210_TEMP] [real] NULL,
	[R_INSTRUMENT_212_TEMP] [real] NULL,
	[R_INSTRUMENT_212_RH] [real] NULL,
	[R_WEIGHING_TEMP] [real] NULL,
	[R_WEIGHING_RH] [real] NULL,
	[R_INSTRUMENT_213_TEMP] [real] NULL,
	[R_INSTRUMENT_213_RH] [real] NULL,
	[R_259_RH] [real] NULL,
	[INCUBATOR_L_210_02_TEMP] [real] NULL,
	[COLD_CHAMBER_L_259_08] [real] NULL,
	[INCUBATOR_L_259_13_TEMP] [real] NULL,
	[R_EX_REAGENT_TEMP] [real] NULL,
	[R_259_TEMP] [real] NULL,
	[R_256_TEMP] [real] NULL,
	[COLD_CHAMBER_L_257_07] [real] NULL
) ON [PRIMARY]'
--PRINT @CREATE_QUERY
EXEC(@CREATE_QUERY)
END
ELSE
BEGIN
  PRINT "TABLE "+ @table_name +" IS EXISTS!"
END

SET @INSERT_QUERY = '
 INSERT [dbo].['+@table_name+'] ([tanggal], [ACS1_AHU14A_SUPPLYAIR_F_CV], [ACS1_AHU14A_FLOW_F_CV], [ACS1_AHU14B_SUPPLYAIR_F_CV], [ACS1_AHU14B_HUMIDITY_F_CV], [ACS1_AHU14B_FLOW_F_CV], [ACS1_AHU16_SUPPLYAIR_F_CV], [ACS1_AHU16_HUMIDITY_F_CV], [ACS1_AHU16_FLOW_F_CV], [ACS1_AHU17_SUPPLYAIR_F_CV], [ACS1_AHU94_SUPPLYAIR_F_CV], [ACS1_AHU94_HUMIDITY_F_CV], [ACS1_AHU94_FLOW_F_CV], [ACS1_AHU24_1_SUPPLYAIR_F_CV], [ACS1_AHU24_1_FLOW_F_CV], [ACS1_AHU24_2_SUPPLYAIR_F_CV], [ACS1_AHU24_2_HUMIDITY_F_CV], [ACS1_AHU24_2_FLOW_F_CV], [ACS1_AHU25_SUPPLYAIR_F_CV], [ACS1_AHU25_FLOW_F_CV], [ACS1_AHU28_SUPPLYAIR_F_CV], [ACS1_AHU28_FLOW_F_CV], [ASPJAKWR809PGZ_STILMAS_WFI_W_TE012], [ASPJAKWR809PGZ_STILMAS_WFI_W_LE015], [ASPJAKWR809PGZ_STILMAS_WFI_W_TE015_1], [ASPJAKWR809PGZ_YokogawaDX2020_CH1_PV_CH07], [ASPJAKWR809PGZ_STILMAS_WFI_W_TE015_5], [ASPJAKWR809PGZ_YokogawaDX2020_CH1_PV_CH10], [ASPJAKWR809PGZ_YokogawaDX2020_CH1_PV_CH11], [ASPJAKWR809PGZ_YokogawaDX2020_CH1_PV_CH08], [ASPJAKWR809PGZ_STILMAS_WFI_W_PT020], [ASPJAKWR809PGZ_STILMAS_WFI_P_LT10_1], [ASPJAKWR809PGZ_STILMAS_WFI_P_TE10_1], [ASPJAKWR809PGZ_STILMAS_WFI_P_TE10_2], [ASPJAKWR809PGZ_STILMAS_WFI_P_TE10_5], [ASPJAKWR809PGZ_YokogawaDX2020_CH1_PV_CH13], [ASPJAKWR809PGZ_STILMAS_WFI_P_PT10_1], [ASPJAKWR809PGZ_YokogawaDX2020_CH1_PV_CH16], [ASPJAKWR809PGZ_YokogawaDX2020_CH1_PV_CH17], [ASPJAKWR809PGZ_YokogawaDX2020_CH1_PV_CH19], [ASPJAKWR809PGZ_YokogawaDX2020_CH1_PV_CH18], [ASPJAKWR809PGZ_YokogawaDX2020_CH1_PV_CH20], [ACS1_TOC_DEMIN_F_CV], [ACS1_ROOM158_TEMP_F_CV], [ACS1_ROOM158_HUMIDITY_F_CV], [ACS1_ROOM160_TEMP_F_CV], [ACS1_ROOM160_HUMIDITY_F_CV], [ACS1_ROOM_WIP_TEMP_F_CV], [ACS1_ROOM_WIP_RH_F_CV], [ACS1_ROOM312_TEMP_F_CV], [ACS1_ROOM312_RH_F_CV], [ACS1_ROOM321_TEMP_F_CV], [ACS1_ROOM314_WIP_TEMP_F_CV], [ACS1_ROOM167_HUMIDITY_F_CV], [ACS1_ROOM167_TEMP_F_CV], [ACS1_ROOM140_TEMP_F_CV], [ACS1_ROOM140_HUMIDITY_F_CV], [ACS1_ROOM125_PRESSURE_F_CV], [ACS1_ROOM126_PRESSURE_F_CV], [ACS1_ROOM127_PRESSURE_F_CV], [ACS1_ROOM128_PRESSURE_F_CV], [ACS1_ROOM140_PRESSURE_F_CV], [ACS1_ROOM141_PRESSURE_F_CV], [ACS1_ROOM145_PRESSURE_F_CV], [ACS1_ROOM129_148_PRESSURE_F_CV], [ASPJAKWR809PGZ_HORNR_STERILE_horner_str_delta_p], [ASPJAKWR809PGZ_HORNR_STERILE_horner_str_ruang_126], [ASPJAKWR809PGZ_HORNR_STERILE_horner_str_ruang_141], [DP_R140_R126], [DP_R141_R126], [ACS1_FIN_GOOD_X1_F_CV], [ACS1_FIN_GOOD_X2_F_CV], [ACS1_FIN_GOOD_X3_F_CV], [ACS1_FIN_GOOD_X4_F_CV], [ACS1_FIN_GOOD_X5_F_CV], [ACS1_FIN_GOOD_X6_F_CV], [ACS1_FIN_GOOD_X7_F_CV], [ACS1_RM_WAREHOUSE_X1_F_CV], [ACS1_RM_WAREHOUSE_X2_F_CV], [ACS1_RM_WAREHOUSE_X3_F_CV], [ACS1_RM_WAREHOUSE_X4_F_CV], [ACS1_RM_WAREHOUSE_X5_F_CV], [ACS1_RM_WAREHOUSE_X6_F_CV], [ACS1_COLDBOX_TEMP_F_CV], [ACS1_FLAMMABLE_TEMP_F_CV], [ACS1_ROOM133_TEMP_F_CV], [ACS1_ROOM133_RH_F_CV], [ACS1_ROOM328_TEMP_F_CV], [ACS1_ROOM328_RH_F_CV], [ACS1_ROOM182A_TEMP_F_CV], [ACS1_ROOM183A_TEMP_F_CV], [ACS1_ROOM183B_TEMP_F_CV], [ACS1_SYSTEM_FLOW_F_CV], [ACS1_SAMPLING_BOOTH_MAT_AIR_LOCK_F_CV], [ACS1_SAMPLING_BOOTH_GOWNING_F_CV], [COLD_CHAMBER_L_214_01], [R_210_TEMP], [R_INSTRUMENT_212_TEMP], [R_INSTRUMENT_212_RH], [R_WEIGHING_TEMP], [R_WEIGHING_RH], [R_INSTRUMENT_213_TEMP], [R_INSTRUMENT_213_RH], [R_259_RH], [INCUBATOR_L_210_02_TEMP], [COLD_CHAMBER_L_259_08], [INCUBATOR_L_259_13_TEMP], [R_EX_REAGENT_TEMP], [R_259_TEMP], [R_256_TEMP], [COLD_CHAMBER_L_257_07]) VALUES '

WHILE @i < @max
BEGIN
 SET @i += 1
 SET @dateStart = DATEADD(minute, 30, @dateStart)
 --PRINT  CONCAT( @i , " ",  @dateStart)
 --SELECT @time
 SET @INSERT_QUERY = @INSERT_QUERY + '("'+ CAST(@dateStart AS VARCHAR(20))
 +'", (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20), (RAND()*(100-5)+-20))'
 IF @i < @max
  SET @INSERT_QUERY = @INSERT_QUERY + ','
 END
PRINT "INSERT DATA" --@INSERT_QUERY
EXEC(@INSERT_QUERY)
GO


